GAAP_ALIASES = {
    "NetCashProvidedByUsedInOperatingActivitiesContinuingOperations": {
        "canonical_key": "cfo_cont_ops",
        "human_label": "Operating Cash Flow – Continuing Ops",
        "aliases": [
            "Net Cash Provided By Used In Operating Activities Continuing Operations",
            "Operating Cash Flow Continuing Operations",
            "CFO – Continuing Operations"
        ]
    },

    "NetIncomeLossAttributableToNoncontrollingInterest": {
        "canonical_key": "net_income_nci",
        "human_label": "Net Income – Noncontrolling Interest",
        "aliases": [
            "Net Income (Loss) Attributable To Noncontrolling Interest",
            "Net Income NCI"
        ]
    },

    "PensionAndOtherPostretirementDefinedBenefitPlansLiabilitiesNoncurrent": {
        "canonical_key": "pension_liabilities_noncurrent",
        "human_label": "Pension & Postretirement Liabilities – Noncurrent",
        "aliases": ["Pension Liabilities Noncurrent"]
    },

    "ProceedsFromSalesOfBusinessAffiliateAndProductiveAssets": {
        "canonical_key": "proceeds_business_sales",
        "human_label": "Proceeds from Sale of Businesses / Assets",
        "aliases": ["Proceeds From Sales Of Business Or Productive Assets"]
    },

    "Revenues": {
        "canonical_key": "revenue",
        "human_label": "Revenue",
        "aliases": ["Revenue", "Revenues", "Sales"]
    },

    "StockholdersEquityOther": {
        "canonical_key": "equity_other",
        "human_label": "Other Stockholders’ Equity",
        "aliases": ["Stockholders Equity Other"]
    },

    "NetCashProvidedByUsedInOperatingActivities": {
        "canonical_key": "cfo",
        "human_label": "Operating Cash Flow",
        "aliases": ["Net Cash Provided By Operating Activities", "Operating Cash Flow"]
    },

    "ImpairmentOfLongLivedAssetsHeldForUse": {
        "canonical_key": "impairment_long_lived_assets",
        "human_label": "Impairment – Long-Lived Assets",
        "aliases": ["Impairment of Long Lived Assets"]
    },

    "SegmentExpenditureAdditionToLongLivedAssets": {
        "canonical_key": "segment_capex",
        "human_label": "Segment Additions to Long-Lived Assets",
        "aliases": ["Segment Additions To Long Lived Assets"]
    },

    "NetIncomeLoss": {
        "canonical_key": "net_income",
        "human_label": "Net Income",
        "aliases": ["Net Income (Loss)", "Net Income"]
    },

    "StockholdersEquityIncludingPortionAttributableToNoncontrollingInterest": {
        "canonical_key": "equity_incl_nci",
        "human_label": "Equity Including NCI",
        "aliases": ["Stockholders Equity Including NCI"]
    },

    "TransferOfFinancialAssetsAccountedForAsSalesAmountDerecognized": {
        "canonical_key": "financial_asset_transfer",
        "human_label": "Financial Asset Transfers Derecognized",
        "aliases": ["Transfer Of Financial Assets Accounted For As Sales"]
    },

    "PrepaidExpenseAndOtherAssetsCurrent": {
        "canonical_key": "prepaid_expenses_current",
        "human_label": "Prepaid Expenses (Current)",
        "aliases": ["Prepaid Expense And Other Assets Current"]
    },

    "DerivativeLiabilitiesCurrent": {
        "canonical_key": "derivative_liabilities_current",
        "human_label": "Derivative Liabilities (Current)",
        "aliases": ["Derivative Liabilities Current"]
    },

    "OtherAssetsCurrent": {
        "canonical_key": "other_assets_current",
        "human_label": "Other Current Assets",
        "aliases": ["Other Assets Current"]
    },

    "IncreaseDecreaseInPrepaidDeferredExpenseAndOtherAssets": {
        "canonical_key": "change_in_other_assets",
        "human_label": "Change in Other Assets",
        "aliases": ["Increase Decrease In Prepaid Deferred Expense And Other Assets"]
    },

    "NetIncomeLossAttributableToRedeemableNoncontrollingInterest": {
        "canonical_key": "net_income_redeemable_nci",
        "human_label": "Net Income – Redeemable NCI",
        "aliases": ["Net Income Attributable To Redeemable NCI"]
    },

    "OtherAccruedLiabilitiesCurrent": {
        "canonical_key": "other_accrued_liabilities_current",
        "human_label": "Other Accrued Liabilities (Current)",
        "aliases": ["Other Accrued Liabilities Current"]
    },

    "NetIncomeLossAttributableToNonredeemableNoncontrollingInterest": {
        "canonical_key": "net_income_nonredeemable_nci",
        "human_label": "Net Income – Nonredeemable NCI",
        "aliases": ["Net Income Attributable To Nonredeemable NCI"]
    },

    "NetIncomeLossIncludingPortionAttributableToNonredeemableNoncontrollingInterest": {
        "canonical_key": "net_income_incl_nonredeemable_nci",
        "human_label": "Net Income – Including Nonredeemable NCI",
        "aliases": ["Net Income Including Nonredeemable NCI"]
    },

    "GrossProfit": {
        "canonical_key": "gross_profit",
        "human_label": "Gross Profit",
        "aliases": ["Gross Profit"]
    },

    "ProceedsFromSaleOfProductiveAssets": {
        "canonical_key": "proceeds_from_asset_sales",
        "human_label": "Proceeds from Productive Asset Sales",
        "aliases": ["Proceeds From Sale Of Productive Assets"]
    },

    "BusinessCombinationRecognizedIdentifiableAssetsAcquiredAndLiabilitiesAssumedLiabilities": {
        "canonical_key": "business_combination_liabilities",
        "human_label": "Business Combination – Liabilities Assumed",
        "aliases": ["Liabilities Assumed In Business Combination"]
    },

    "DisposalGroupIncludingDiscontinuedOperationGrossProfitLoss": {
        "canonical_key": "disposal_group_gross_profit",
        "human_label": "Gross Profit (Disposal Group)",
        "aliases": ["Disposal Group Gross Profit Or Loss"]
    },

    "LiabilitiesOfDisposalGroupIncludingDiscontinuedOperationCurrent": {
        "canonical_key": "disposal_group_liabilities_current",
        "human_label": "Current Liabilities – Disposal Group",
        "aliases": ["Disposal Group Current Liabilities"]
    },

    "StockholdersEquityNoteSpinoffTransaction": {
        "canonical_key": "equity_spinoff",
        "human_label": "Equity – Spinoff Transaction",
        "aliases": ["Equity Spinoff Transaction"]
    },

    "DeferredTaxAssetsOperatingLossCarryforwards": {
        "canonical_key": "dta_nol",
        "human_label": "Deferred Tax Assets – NOL",
        "aliases": ["Deferred Tax Assets Operating Loss Carryforwards"]
    },

    "OtherLiabilitiesNoncurrent": {
        "canonical_key": "other_liabilities_noncurrent",
        "human_label": "Other Liabilities (Noncurrent)",
        "aliases": ["Other Liabilities Noncurrent"]
    },

    "PaymentsToAcquireIntangibleAssets": {
        "canonical_key": "capex_intangibles",
        "human_label": "Payments to Acquire Intangible Assets",
        "aliases": ["Payments To Acquire Intangible Assets"]
    },

    "StockholdersEquity": {
        "canonical_key": "equity",
        "human_label": "Stockholders’ Equity",
        "aliases": ["Stockholders Equity"]
    },

    "SalesRevenueServicesGross": {
        "canonical_key": "revenue_gross",
        "human_label": "Gross Revenue",
        "aliases": ["Sales Revenue Services Gross"]
    },

    "OtherAssetsNoncurrent": {
        "canonical_key": "other_assets_noncurrent",
        "human_label": "Other Assets (Noncurrent)",
        "aliases": ["Other Assets Noncurrent"]
    },

    "StockholdersEquityNoteStockSplitConversionRatio1": {
        "canonical_key": "equity_stock_split",
        "human_label": "Equity – Stock Split Conversion",
        "aliases": ["Equity Stock Split Conversion"]
    },

    "DeferredTaxAssetsOtherComprehensiveLoss": {
        "canonical_key": "dta_oci_loss",
        "human_label": "Deferred Tax Assets – OCI Loss",
        "aliases": ["Deferred Tax Assets Other Comprehensive Loss"]
    },

    "DeferredTaxLiabilitiesPropertyPlantAndEquipment": {
        "canonical_key": "dtl_ppe",
        "human_label": "Deferred Tax Liabilities – PPE",
        "aliases": ["Deferred Tax Liabilities PPE"]
    },

    "OtherAssetsMiscellaneousNoncurrent": {
        "canonical_key": "misc_assets_noncurrent",
        "human_label": "Miscellaneous Assets (Noncurrent)",
        "aliases": ["Other Assets Miscellaneous Noncurrent"]
    },

    "NetIncomeLossPerOutstandingLimitedPartnershipUnitBasicNetOfTax": {
        "canonical_key": "net_income_lp_basic",
        "human_label": "Net Income per LP Unit (Basic)",
        "aliases": ["Net Income Per Outstanding LP Unit Basic Net Of Tax"]
    },

    "OtherLiabilitiesFairValueDisclosure": {
        "canonical_key": "other_liabilities_fair_value",
        "human_label": "Other Liabilities – Fair Value",
        "aliases": ["Other Liabilities (Fair Value)"]
    },

    "PaymentsToAcquireProductiveAssets": {
        "canonical_key": "capex_productive",
        "human_label": "Payments to Acquire Productive Assets",
        "aliases": ["Payments To Acquire Productive Assets"]
    },

    "NoncashOrPartNoncashAcquisitionValueOfLiabilitiesAssumed1": {
        "canonical_key": "noncash_liabilities_acquired",
        "human_label": "Non-cash Liabilities Assumed",
        "aliases": ["Noncash Acquisition Liabilities Assumed"]
    },

    "PensionAndOtherPostretirementAndPostemploymentBenefitPlansLiabilitiesCurrentAndNoncurrent": {
        "canonical_key": "pension_liabilities_total",
        "human_label": "Pension & Benefit Liabilities (Total)",
        "aliases": ["Pension Liabilities Total"]
    },

    "NetIncomeLossPerOutstandingLimitedPartnershipAndGeneralPartnershipUnitBasicAndDiluted": {
        "canonical_key": "net_income_lp_basic_diluted",
        "human_label": "Net Income per LP Unit (Basic & Diluted)",
        "aliases": ["Net Income LP Units Basic And Diluted"]
    },

    "ImpairmentOfIntangibleAssetsIndefinitelivedExcludingGoodwill": {
        "canonical_key": "impairment_intangibles",
        "human_label": "Impairment – Indefinite-Lived Intangibles",
        "aliases": ["Intangible Impairment Excluding Goodwill"]
    },

    "AssetsOfDisposalGroupIncludingDiscontinuedOperationCurrent": {
        "canonical_key": "disposal_group_assets_current",
        "human_label": "Current Assets – Disposal Group",
        "aliases": ["Disposal Group Current Assets"]
    },

    "NetIncomeLossAvailableToCommonStockholdersDiluted": {
        "canonical_key": "net_income_common_diluted",
        "human_label": "Net Income Available to Common – Diluted",
        "aliases": ["Net Income Common Stockholders Diluted"]
    },

    "VariableInterestEntityConsolidatedCarryingAmountAssets": {
        "canonical_key": "vie_assets",
        "human_label": "VIE Consolidated Assets",
        "aliases": ["VIE Assets"]
    },

    "VariableInterestEntityConsolidatedCarryingAmountLiabilities": {
        "canonical_key": "vie_liabilities",
        "human_label": "VIE Consolidated Liabilities",
        "aliases": ["VIE Liabilities"]
    },

    "EffectiveIncomeTaxRateReconciliationChangeInDeferredTaxAssetsValuationAllowance": {
        "canonical_key": "tax_rate_change_val_allowance",
        "human_label": "Tax Rate – Change in Valuation Allowance",
        "aliases": ["Tax Valuation Allowance Change"]
    },

    "LiabilitiesAndStockholdersEquity": {
        "canonical_key": "liabilities_and_equity",
        "human_label": "Liabilities & Stockholders’ Equity",
        "aliases": ["Liabilities And Equity"]
    },

    "DisposalGroupIncludingDiscontinuedOperationOtherAssets": {
        "canonical_key": "disposal_group_other_assets",
        "human_label": "Other Assets – Disposal Group",
        "aliases": ["Disposal Group Other Assets"]
    },

    "DisposalGroupIncludingDiscontinuedOperationOtherLiabilities": {
        "canonical_key": "disposal_group_other_liabilities",
        "human_label": "Other Liabilities – Disposal Group",
        "aliases": ["Disposal Group Other Liabilities"]
    },

    "OtherLiabilities": {
        "canonical_key": "other_liabilities",
        "human_label": "Other Liabilities",
        "aliases": ["Other Liabilities"]
    },

    "SalesRevenueServicesNet": {
        "canonical_key": "revenue_net",
        "human_label": "Net Revenue",
        "aliases": ["Sales Revenue Services Net"]
    },

    "ProceedsFromSaleOfOtherAssetsInvestingActivities": {
        "canonical_key": "proceeds_asset_sale_investing",
        "human_label": "Proceeds from Other Asset Sales (Investing)",
        "aliases": ["Proceeds From Sale Of Other Assets (Investing)"]
    },

    "OtherSundryLiabilities": {
        "canonical_key": "other_sundry_liabilities",
        "human_label": "Other Sundry Liabilities",
        "aliases": ["Other Sundry Liabilities"]
    },

    "VariableInterestEntityNonconsolidatedCarryingAmountAssets": {
        "canonical_key": "vie_nonconsolidated_assets",
        "human_label": "VIE Non-consolidated Assets",
        "aliases": ["VIE Nonconsolidated Assets"]
    },

    "PaymentsForProceedsFromProductiveAssets": {
        "canonical_key": "capex_net_productive",
        "human_label": "Net Payments/Proceeds – Productive Assets",
        "aliases": ["Payments For / Proceeds From Productive Assets"]
    },

    "EmployeeRelatedLiabilitiesCurrentAndNoncurrent": {
        "canonical_key": "employee_liabilities_total",
        "human_label": "Employee-Related Liabilities (Total)",
        "aliases": ["Employee Related Liabilities Total"]
    },

    "EmployeeRelatedLiabilitiesCurrent": {
        "canonical_key": "employee_liabilities_current",
        "human_label": "Employee-Related Liabilities (Current)",
        "aliases": ["Employee Related Liabilities Current"]
    },

    "IncomeTaxReconciliationChangeInDeferredTaxAssetsValuationAllowance": {
        "canonical_key": "tax_change_valuation_allowance",
        "human_label": "Deferred Tax Asset Valuation Allowance Change",
        "aliases": ["Change In DTA Valuation Allowance"]
    },

    "DeferredTaxAssetsInProcessResearchAndDevelopment": {
        "canonical_key": "dta_rnd",
        "human_label": "Deferred Tax Assets – IPR&D",
        "aliases": ["DTA In Process R&D"]
    },

    "OtherSundryLiabilitiesNoncurrent": {
        "canonical_key": "other_sundry_liabilities_noncurrent",
        "human_label": "Other Sundry Liabilities (Noncurrent)",
        "aliases": ["Other Sundry Liabilities Noncurrent"]
    },

    "DeferredTaxAssetsOther": {
        "canonical_key": "dta_other",
        "human_label": "Deferred Tax Assets – Other",
        "aliases": ["Deferred Tax Assets Other"]
    },

    "DeferredTaxLiabilitiesGoodwillAndIntangibleAssetsIntangibleAssets": {
        "canonical_key": "dtl_goodwill_intangibles",
        "human_label": "Deferred Tax Liabilities – Goodwill & Intangibles",
        "aliases": ["DTL Goodwill And Intangibles"]
    },

    "DeferredTaxAssetsOperatingLossCarryforwardsStateAndLocal": {
        "canonical_key": "dta_nol_state_local",
        "human_label": "Deferred Tax Assets – NOL State/Local",
        "aliases": ["DTA NOL State And Local"]
    },

    "DeferredTaxLiabilitiesUndistributedForeignEarnings": {
        "canonical_key": "dtl_undistributed_foreign",
        "human_label": "Deferred Tax Liabilities – Undistributed Foreign Earnings",
        "aliases": ["DTL Undistributed Foreign Earnings"]
    },

    "DeferredTaxAssetsDerivativeInstruments": {
        "canonical_key": "dta_derivatives",
        "human_label": "Deferred Tax Assets – Derivatives",
        "aliases": ["DTA Derivative Instruments"]
    },

    "DeferredTaxLiabilitiesDerivatives": {
        "canonical_key": "dtl_derivatives",
        "human_label": "Deferred Tax Liabilities – Derivatives",
        "aliases": ["DTL Derivatives"]
    },

    "DeferredTaxLiabilitiesInvestmentInNoncontrolledAffiliates": {
        "canonical_key": "dtl_investment_affiliates",
        "human_label": "Deferred Tax Liabilities – Noncontrolled Affiliates",
        "aliases": ["DTL Investment In Noncontrolled Affiliates"]
    },

    "DeferredTaxAssetsPropertyPlantAndEquipment": {
        "canonical_key": "dta_ppe",
        "human_label": "Deferred Tax Assets – PPE",
        "aliases": ["Deferred Tax Assets PPE"]
    },

    "FiniteLivedIntangibleAssetsAmortizationExpenseYearFive": {
        "canonical_key": "amortization_year5",
        "human_label": "Amortization Expense – Year 5",
        "aliases": ["Intangible Amortization Year 5"]
    },

    "OtherAssetsFairValueDisclosure": {
        "canonical_key": "other_assets_fair_value",
        "human_label": "Other Assets – Fair Value",
        "aliases": ["Other Assets (Fair Value)"]
    },

    "DeferredTaxAssetsUnrealizedLossesOnAvailableforSaleSecuritiesGross": {
        "canonical_key": "dta_unrealized_losses_afs",
        "human_label": "Deferred Tax Assets – Unrealized Losses (AFS)",
        "aliases": ["DTA Unrealized Losses On AFS Securities"]
    },

    "DeferredTaxLiabilitiesUnrealizedGainsOnTradingSecurities": {
        "canonical_key": "dtl_unrealized_gains_trading",
        "human_label": "Deferred Tax Liabilities – Unrealized Gains (Trading)",
        "aliases": ["DTL Unrealized Gains Trading Securities"]
    },

    "DeferredTaxAssetsOperatingLossCarryforwardsDomestic": {
        "canonical_key": "dta_nol_domestic",
        "human_label": "Deferred Tax Assets – NOL Domestic",
        "aliases": ["DTA NOL Domestic"]
    },

    "DeferredIncomeTaxesAndOtherAssetsCurrent": {
        "canonical_key": "deferred_taxes_other_current",
        "human_label": "Deferred Taxes & Other Assets (Current)",
        "aliases": ["Deferred Income Taxes And Other Assets Current"]
    },

    "SeparateAccountAssets": {
        "canonical_key": "separate_account_assets",
        "human_label": "Separate Account Assets",
        "aliases": ["Separate Account Assets"]
    },

    "DeferredTaxAssetsCapitalLossCarryforwards": {
        "canonical_key": "dta_capital_loss_cf",
        "human_label": "Deferred Tax Assets – Capital Loss CF",
        "aliases": ["DTA Capital Loss Carryforwards"]
    },

    "DeferredTaxAssetsDeferredIncome": {
        "canonical_key": "dta_deferred_income",
        "human_label": "Deferred Tax Assets – Deferred Income",
        "aliases": ["DTA Deferred Income"]
    },

    "DeferredTaxAssetsOperatingLossCarryforwardsForeign": {
        "canonical_key": "dta_nol_foreign",
        "human_label": "Deferred Tax Assets – NOL Foreign",
        "aliases": ["DTA NOL Foreign"]
    },

    "NetIncomeLossAvailableToCommonStockholdersBasic": {
        "canonical_key": "net_income_common_basic",
        "human_label": "Net Income Available to Common – Basic",
        "aliases": ["Net Income Common Stockholders Basic"]
    },

    "DeferredIncomeTaxAssetsNet": {
        "canonical_key": "dta_net",
        "human_label": "Deferred Income Tax Assets – Net",
        "aliases": ["Deferred Income Tax Assets Net"]
    },

    "NetIncomeLossAttributableToParentDiluted": {
        "canonical_key": "net_income_parent_diluted",
        "human_label": "Net Income Attributable to Parent – Diluted",
        "aliases": ["Net Income Parent Diluted"]
    },

    "StockholdersEquityOtherShares": {
        "canonical_key": "equity_other_shares",
        "human_label": "Other Equity Shares",
        "aliases": ["Stockholders Equity Other Shares"]
    },

    "SecuritiesLoanedIncludingNotSubjectToMasterNettingArrangementAndAssetsOtherThanSecuritiesTransferred": {
        "canonical_key": "securities_loaned",
        "human_label": "Securities Loaned",
        "aliases": ["Securities Loaned Not Subject To Netting"]
    },

    "ShareBasedCompensationArrangementByShareBasedPaymentAwardEquityInstrumentsOtherThanOptionsShareBasedLiabilitiesPaid": {
        "canonical_key": "share_based_liabilities_paid",
        "human_label": "Share-based Payment Liabilities Paid",
        "aliases": ["Share Based Comp Liabilities Paid"]
    },

    "VariableInterestEntityConsolidatedAssetsPledged": {
        "canonical_key": "vie_assets_pledged",
        "human_label": "VIE Assets Pledged",
        "aliases": ["VIE Assets Pledged"]
    },

    "VariableInterestEntityConsolidatedLiabilitiesNoRecourse": {
        "canonical_key": "vie_liabilities_no_recourse",
        "human_label": "VIE Liabilities (No Recourse)",
        "aliases": ["VIE No-recourse Liabilities"]
    },

    "IntangibleAssetsGrossExcludingGoodwill": {
        "canonical_key": "intangibles_gross_excl_goodwill",
        "human_label": "Intangible Assets (Gross, Excluding Goodwill)",
        "aliases": ["Intangible Assets Gross Excluding Goodwill"]
    },
    "DeferredIncomeTaxesAndOtherLiabilitiesNoncurrent": {
        "canonical_key": "deferred_taxes_and_other_liabilities_noncurrent",
        "human_label": "Deferred Income Taxes And Other Liabilities (Noncurrent)",
        "aliases": [
            "Deferred Income Taxes And Other Liabilities Noncurrent",
        ],
    },
    "DeferredTaxAndOtherLiabilitiesNoncurrent": {
        "canonical_key": "deferred_tax_and_other_liabilities_noncurrent",
        "human_label": "Deferred Tax And Other Liabilities (Noncurrent)",
        "aliases": [
            "Deferred Tax And Other Liabilities Noncurrent",
        ],
      "OtherLiabilitiesCurrent": {
        "canonical_key": "other_liabilities_current",
        "human_label": "Other Liabilities, Current",
        "unit": "USD",
    },
        "VariableInterestEntityActivityBetweenVIEAndEntityRevenues": {
        "canonical_key": "vie_activity_between_vie_and_entity_revenues",
        "human_label": "VIE Activity Between VIE and Entity Revenues",
        "unit": "USD",
    },
 
    "EquityMethodInvestmentSummarizedFinancialInformationGrossProfitLoss": {
        "canonical_key": "equity_method_investment_gross_profit_loss",
        "human_label": "Equity Method Investment Summarized Gross Profit (Loss)",
        "unit": "USD",
    },
 
    "NetIncomeLossPerOutstandingLimitedPartnershipUnitDiluted": {
        "canonical_key": "net_income_loss_per_lp_unit_diluted",
        "human_label": (
            "Net Income (Loss) per Outstanding Limited Partnership Unit, Diluted"
        ),
        "unit": "USD_per_unit",  # EPS-style metric
    },
    
    }
}


from typing import Optional

def get_canonical_key(metric_code: str) -> Optional[str]:
    info = GAAP_ALIASES.get(metric_code)
    return info["canonical_key"] if info else None


def get_human_label(metric_code: str) -> Optional[str]:
    info = GAAP_ALIASES.get(metric_code)
    return info["human_label"] if info else None
